<!--pages/user/index.wxml-->
<view class="user-container">
  <!-- 用户信息卡片 -->
  <view class="user-header card">
    <view class="user-bg"></view>
    <view class="user-info">
      <image
        class="user-avatar"
        src="/images/default-avatar.png"
        mode="aspectFill"
      ></image>
      <view class="user-detail">
        <text class="user-name">欢迎来到画海民宿</text>
        <text class="user-desc">南澳岛旅游指南</text>
      </view>
    </view>
  </view>

  <!-- 我的收藏 -->
  <view class="favorites-section card">
    <view class="section-header">
      <text class="section-title">⭐ 我的收藏</text>
      <text class="section-count" wx:if="{{favorites.length > 0}}">{{favorites.length}} 家</text>
    </view>

    <!-- 加载状态 -->
    <view class="loading-state" wx:if="{{loading}}">
      <text class="loading-text">加载中...</text>
    </view>

    <!-- 空状态 -->
    <view class="empty-state" wx:if="{{!loading && favorites.length === 0}}">
      <text class="empty-text">暂无收藏，去首页看看吧</text>
    </view>

    <!-- 收藏列表 -->
    <view class="favorites-list" wx:if="{{!loading && favorites.length > 0}}">
      <view
        class="favorite-item"
        wx:for="{{favorites}}"
        wx:key="_id"
        data-id="{{item._id}}"
        bindtap="openGuide"
      >
        <image class="favorite-image" src="{{item.cover}}" mode="aspectFill"></image>
        <view class="favorite-content">
          <text class="favorite-title">{{item.title}}</text>
          <text class="favorite-desc">{{item.summary}}</text>
        </view>
        <view
          class="favorite-remove"
          catchtap="removeFavorite"
          data-id="{{item._id}}"
        >
          <text>✕</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 功能菜单 -->
  <view class="menu-section card">
    <view class="menu-item" bindtap="contactService">
      <view class="menu-left">
        <text class="menu-icon">📞</text>
        <text class="menu-label">联系客服</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>

    <view class="menu-divider"></view>

    <view class="menu-item" bindtap="showAbout">
      <view class="menu-left">
        <text class="menu-icon">ℹ️</text>
        <text class="menu-label">关于我们</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>

    <view class="menu-divider"></view>

    <!-- 数据初始化入口（隐藏） -->
    <view class="menu-item" bindtap="goToInit">
      <view class="menu-left">
        <text class="menu-icon">⚙️</text>
        <text class="menu-label">数据初始化</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>
  </view>
</view>
