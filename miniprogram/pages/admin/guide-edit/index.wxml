<!--pages/admin/guide-edit/index.wxml-->
<view class="edit-container">
  <view class="form-section">
    <!-- 基本信息 -->
    <view class="form-item">
      <text class="form-label">标题 *</text>
      <input
        class="form-input"
        placeholder="请输入攻略标题"
        value="{{form.title}}"
        data-field="title"
        bindinput="onInput"
        maxlength="50"
      />
    </view>

    <view class="form-item">
      <text class="form-label">分类 *</text>
      <picker
        class="form-picker"
        range="{{categories}}"
        range-key="label"
        value="{{form.category}}"
        bindchange="onCategoryChange"
      >
        <view class="picker-value">{{categoryLabel}}</view>
      </picker>
    </view>

    <view class="form-item">
      <text class="form-label">标签</text>
      <input
        class="form-input"
        placeholder="用逗号分隔，如：海鲜,地道,必吃"
        value="{{form.tags.join(',')}}"
        bindinput="onTagsInput"
      />
    </view>

    <view class="form-item">
      <text class="form-label">摘要 *</text>
      <textarea
        class="form-textarea"
        placeholder="请输入简要描述"
        value="{{form.summary}}"
        data-field="summary"
        bindinput="onInput"
        maxlength="200"
      />
    </view>

    <!-- 封面图 -->
    <view class="form-item">
      <text class="form-label">封面图片</text>
      <view class="image-upload">
        <view class="uploaded-images" wx:if="{{form.cover}}">
          <image
            class="upload-image"
            src="{{form.cover}}"
            mode="aspectFill"
            data-url="{{form.cover}}"
            data-type="cover"
            bindtap="previewImage"
          />
          <view class="delete-btn" catchtap="deleteCover">✕</view>
        </view>
        <view class="upload-btn" wx:if="{{!form.cover}}" bindtap="chooseCover">
          <text class="upload-icon">+</text>
          <text class="upload-text">上传封面</text>
        </view>
      </view>
    </view>

    <!-- 图片列表 -->
    <view class="form-item">
      <text class="form-label">图片列表（最多9张）</text>
      <view class="image-upload">
        <view class="uploaded-images">
          <view class="image-item" wx:for="{{form.images}}" wx:key="*this">
            <image
              class="upload-image"
              src="{{item}}"
              mode="aspectFill"
              data-url="{{item}}"
              data-type="images"
              data-index="{{index}}"
              bindtap="previewImage"
            />
            <view class="delete-btn" catchtap="deleteImage" data-index="{{index}}">✕</view>
          </view>
        </view>
        <view class="upload-btn" wx:if="{{form.images.length < 9}}" bindtap="chooseImages">
          <text class="upload-icon">+</text>
          <text class="upload-text">添加图片</text>
        </view>
      </view>
    </view>

    <!-- 详细内容 -->
    <view class="form-item">
      <text class="form-label">详细内容 *</text>
      <textarea
        class="form-textarea rich-text"
        placeholder="支持HTML标签，如：h3标题、p段落、strong加粗等"
        value="{{form.content}}"
        data-field="content"
        bindinput="onInput"
        maxlength="-1"
      />
    </view>

    <view class="form-item">
      <text class="form-label">地址</text>
      <input
        class="form-input"
        placeholder="请输入详细地址"
        value="{{form.address}}"
        data-field="address"
        bindinput="onInput"
      />
    </view>
  </view>

  <!-- 底部按钮 -->
  <view class="bottom-actions">
    <button class="action-btn primary" bindtap="save" disabled="{{uploading}}">
      <text>{{isEdit ? '更新' : '发布'}}攻略</text>
    </button>
  </view>
</view>
