<!--pages/admin/guides/index.wxml-->
<view class="guides-container">
  <!-- ç­›é€‰æ  -->
  <view class="filter-bar">
    <picker
      class="filter-picker"
      mode="selector"
      range="{{['å…¨éƒ¨', 'å·²å‘å¸ƒ', 'è‰ç¨¿']}}"
      bindchange="onFilterChange"
      data-field="status"
    >
      <view class="picker-value">
        <text>çŠ¶æ€ç­›é€‰</text>
        <text class="picker-arrow">â–¼</text>
      </view>
    </picker>

    <picker
      class="filter-picker"
      mode="selector"
      range="{{['å…¨éƒ¨', 'ç¾é£Ÿæ¨è', 'æ¸¸ç©è·¯çº¿', 'å®ç”¨ä¿¡æ¯', 'æ™¯ç‚¹æ‰“å¡']}}"
      bindchange="onFilterChange"
      data-field="category"
    >
      <view class="picker-value">
        <text>åˆ†ç±»ç­›é€‰</text>
        <text class="picker-arrow">â–¼</text>
      </view>
    </picker>
  </view>

  <!-- æ”»ç•¥åˆ—è¡¨ -->
  <view class="guides-list">
    <view class="empty-state" wx:if="{{!loading && guides.length === 0}}">
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-text">æš‚æ— æ”»ç•¥</text>
    </view>

    <view
      class="guide-item card"
      wx:for="{{guides}}"
      wx:key="_id"
    >
      <view class="item-header">
        <text class="item-title">{{item.title}}</text>
        <view class="item-status {{item.status === 'published' ? 'published' : 'draft'}}">
          <text>{{item.status === 'published' ? 'å·²å‘å¸ƒ' : 'è‰ç¨¿'}}</text>
        </view>
      </view>

      <view class="item-info">
        <text class="info-tag">{{item.category}}</text>
        <text class="info-text">æµè§ˆ {{item.views || 0}}</text>
        <text class="info-text">æ”¶è— {{item.likes || 0}}</text>
      </view>

      <view class="item-actions">
        <button
          class="action-btn edit"
          data-id="{{item._id}}"
          catchtap="editGuide"
        >
          <text>ç¼–è¾‘</text>
        </button>
        <button
          class="action-btn toggle"
          data-id="{{item._id}}"
          data-status="{{item.status}}"
          catchtap="toggleStatus"
        >
          <text>{{item.status === 'published' ? 'ä¸‹æ¶' : 'å‘å¸ƒ'}}</text>
        </button>
        <button
          class="action-btn delete"
          data-id="{{item._id}}"
          data-title="{{item.title}}"
          catchtap="deleteGuide"
        >
          <text>åˆ é™¤</text>
        </button>
      </view>
    </view>
  </view>

  <!-- æ·»åŠ æŒ‰é’® -->
  <view class="add-btn" bindtap="addGuide">
    <text class="add-icon">+</text>
  </view>
</view>
